name: 04 Delete Repositories

on:
  workflow_dispatch:

jobs:
  delete_repositories:
    runs-on: ubuntu-latest

    env:
      GH_TOKEN: ${{ secrets.GITHUB_TOKEN }} # GitHub トークンを使用

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Read .env file
      run: |
        source ./.env

    - name: Read delete_target.txt file
      id: read-delete-target
      run: |
        cat delete_target.txt

    - name: Delete repositories
      run: |
        while read line; do
          reponame="$USER_NAME/$line"
          gh repo delete "$reponame" --yes
          echo "Deleted $reponame"
        done < delete_target.txt
