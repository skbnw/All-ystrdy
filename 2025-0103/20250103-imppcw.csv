headline,mainEntityOfPage,image,datePublished,dateModified,author,media_en,media_jp,str_count,body,images,external_links
Windowsの調子が……最終手段のクリーンインストールで覚えておきたいテクニック。ローカルアカウントの作り方も紹介（PC Watch）,https://news.yahoo.co.jp/articles/cb60cd02de2c18b914256d33352a43713fd0270f,https://newsatcl-pctr.c.yimg.jp/t/amd-img/20250103-00000012-imppcw-000-1-view.jpg?exp=10800,2025-01-03T06:05:32+09:00,2025-01-03T06:05:32+09:00,PC Watch,imppcw,PC Watch,3727,"写真：PC Watch
Windowsを新しいバージョンにアップグレードするとき、ストレージなどのPCパーツを交換したとき、PCが不調のときなど、クリーンインストールして一新したくなるタイミングがあったりするもの。ただ、OSのさまざまな設定やアプリケーションが消えたり、初期状態に戻ってしまうため、元の使い勝手に戻すのは大変。そう思っている人もいるかもしれない。
【画像】ストレージはOSとデータとで日頃から分けて管理しておくと楽
でも、Windows 11ならクリーンインストールでも以前ほど手間をかけずに元の環境に近づけることが可能になっている。今回は、クリーンインストールするときに知っておきたいポイントとなるテクニックをいくつか紹介しよう。

■ データはできるだけ別ドライブかクラウドストレージにまとめておく

　最初にまずやっておきたいことの1つは、データの退避。クリーンインストールするということは、起動ドライブに何もデータがない(あるいは新品のストレージを使う)状態にするということ。なので、画像や文書など、大事なデータはすべて起動ドライブ以外のデータ専用ドライブにまとめておくのが基本だ。

　もしくは、そういったデータ類は常にOneDriveやDropboxなどのクラウドストレージで同期するようにして、オンライン上に残しておくのもおすすめ。そうすれば、データドライブが用意できない場合でも後でクラウドから元通りに復元できる。そのためには十分なクラウドストレージ容量が必要になる、という点にだけ気を付けておこう。

■ Windows 11の最新インストールイメージを取得する方法

　クリーンインストールに必須となるのが、Windowsのインストールイメージ。ご存じの人も多いと思うが、Windows 11の最新インストールイメージを作成するためのツール「Windows 11 メディア作成ツール」は、MicrosoftのWebサイトから誰でもダウンロードできる。ツールをダウンロード後、自分のPCの環境に合ったタイプ、バージョンを選んでUSBメモリなどにインストールしよう。

■ Windowsの基本的なデータ、設定を保存する方法

　Windows 11には、OSの基本的な設定やデータをクラウドにバックアップしておける「Windows バックアップ」というツールが用意されている。クリーンインストール前にはこちらも必ず確認しておきたい。

　Windows バックアップでは、MicrosoftアカウントとOneDriveを利用して、壁紙や配色、Wi-FiなどOSの各種設定のほか、ドキュメント、写真、デスクトップといった特定フォルダ内のデータ、インストールしているアプリ(の情報)をクラウドに保存しておける。

　下記の手順でバックアップを有効にしておき、無事バックアップが完了したなら準備OK。後はWindowsをインストールする際、初期セットアップ画面でMicrosoftアカウントでログインすれば、バックアップしていたそれらのデータを復元してWindowsを使い始められるようになる。

　復元タイミングはこの初期セットアップのタイミングしかなく、MicrosoftアカウントでのログインなしでWindowsを使い始めてしまうと利用できなくなるので注意。

　また、ここで同期される「アプリ」はMicrosoft Storeで公開されているもののみ。ほかは「アプリがインストールされていた」という情報のみが引き継がれ、アプリケーションアイコンが表示されるだけなので、改めて手動でインストールする必要がある。

■ Webブラウザの「タブ」もクラウドに同期しておく方法

　よくアクセスするWebサイトは「お気に入り」に登録して利用している人が多いと思うが、そのデータはログインしているアカウントにひも付けられている。たとえばGoogle Chromeの場合、Google アカウントでログインしていれば、クリーンインストール後にログインし直すだけでお気に入り登録したものをすべて復元可能だ。

　ただし、タブで開いているWebサイトについてはその限りではない。後で見ようととりあえず大量に開いていたタブは、閲覧履歴に残ることはあっても、クリーンインストール後に自動で再び同じように開いてくれるわけではないのだ。

　それだと困る、という場合は、タブで開いているWebサイトを下記の要領でいったんタブグループにまとめ、さらに「グループを保存」しておこう。こうするとタブバーにタブグループが登録され、お気に入りと同じようにGoogle アカウントの同期対象となる。

■ インストールしていたアプリケーションを復元できるようにする方法

　クリーンインストール後、元の環境に近づけるのに一番やっかいなのがアプリケーションだ。どれをインストールしていたのかすべて把握しておくのは難しいし、1つ1つ再インストールするのも膨大な手間がかかる。クリーンインストール後、いつもの手順で何かを操作しようとしたら、アプリケーションがインストールされていなかった、と気付くことも多い。

　Windowsバックアップで同期される「アプリ」はその解決策の1つではあるが、インストールされなかったアプリケーションの確認はしにくい。そこで試したいのがWindows 11標準の「winget」コマンドだ。

　wingetコマンドはコマンドプロンプトなどから実行できるもので、Unix系OSやスクリプト言語(開発環境)におけるパッケージマネージャーに似ている。個別にアプリケーションのインストール・アンインストール・アップデートが可能なほか、インストール済みアプリケーションを一覧したり、その一覧をJSON形式で出力したり、出力した一覧からまとめて再インストールしたりすることもできる。

　おそらくはWindowsバックアップの「アプリ」もこの仕組みを利用していると思われる。しかし一覧で見られるようにしておけば、インストールしていたアプリケーションを後からすべて把握できるし、自動でインストールされなかったものもその一覧を見ながら再インストールすれば、以前の状態を復元する労力を減らせるだろう。

　ただ、コマンド操作は少し大変だし分かりにくい。ということで紹介したいのが「UniGetUI」というソフト。wingetコマンドの機能をGUIで分かりやすく操作できるもので、一般的なWindowsアプリケーションに加えて、PythonやNode.js、.NET Toolなどのパッケージマネージャーにも対応する。一般ユーザーだけでなく開発者にとってもお役立ちなツールだ。

■ ローカルアカウントでWindowsを使い始められるようにする方法

　Windowsインストールの初期セットアップ時、Microsoftアカウントのログインが強制されたり、追加の更新やソフトウェアがダウンロードされたりすることがある。完全にまっさらなデスクトップから始めたい、と思っている人にとっては少し面倒だ。

　そんなときは、初期セットアップ中に特定のコマンドを実行することで、ログインやネットワーク接続なしに進めることができる。下記の手順で操作してみよう。ただし、先ほど説明したWindows バックアップからの復元は不可能になるので、今回のようなケースではあまりおすすめしない。家族や友人のPCを代わりにセットアップしてあげる、みたいなシチュエーションで役に立つだろう。

■ 環境復元は大事だが、“クリーンインストール”であることを忘れずに

　以上の方法でクリーンインストールに臨めば、環境を一新しながらも、以前のPCの使い勝手にすばやく近づけることが可能になるはず。ただし、Windows バックアップではフォントやプリンタなどは引き継がれないので、別途手動でバックアップやドライバ等の再インストールが必要。もちろんアプリケーションごとの設定も再インストールすれば基本的には初期状態となるから、個別に対処しておかなければならない。

　ちなみにアプリケーションについては、インストールしたフォルダと同じ場所に作られたiniファイルなどで設定を管理しているレガシーなタイプであれば、そこをバックアップしておけば手間が少ない。が、最近は「%APPDATA%」というユーザーごとの隠しシステムフォルダに保存されるパターンも増えてきているので、ここも念のためバックアップしておくとよいだろう。

　ただ、あまりに多くの設定を引き継いで以前の環境とほとんど変わらない状況になってしまうと、今度は「何をもってクリーンインストールなのか」という疑問も生じがち。いかに以前と同じように設定し直すかにこだわるよりも、自分の頭の中もリセットして、以前よりもっと使いやすくなるように！という思いで設定し直すほうが楽しいのではないだろうか。
PC Watch,日沼 諭史",[],[]
