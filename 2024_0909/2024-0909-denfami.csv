headline,mainEntityOfPage,image,datePublished,dateModified,author,media_en,media_jp,str_count,body,images,external_links
『学園アイドルマスター』開発陣の熱意とこだわりようがヤバすぎてもはや怖い。全ては「モバイル3D美少女の最高クオリティ」を目指すため（電ファミニコゲーマー）,https://news.yahoo.co.jp/articles/9dde3c844419ce2fb2ca2e43704472f5b33bd918,https://newsatcl-pctr.c.yimg.jp/t/amd-img/20240909-01225021-denfami-000-4-view.jpg?exp=10800,2024-09-09T12:15:54+09:00,2024-09-09T12:16:06+09:00,電ファミニコゲーマー,denfami,電ファミニコゲーマー,10327,\nアイドルたちの頭から足まで…にはとどまらず、さらに魅力を引き出すべく光や風表現、髪の毛1本にまで追求する全ては「モバイル3D美少女の最高クオリティ」を目指すため\n8月21日から8月23日にかけて開催されたゲーム開発者向けカンファレンス「CEDEC2024」の初日、「神は細部に宿る！「学園アイドルマスター」のこだわり抜いた3Dキャラクター・背景制作」が行われた。\n【この記事に関連するほかの画像を見る】\n講演者は『学園アイドルマスター』の開発元である株式会社QualiArtsの3Dディレクター・杉村貴之氏とテクニカルアーティスト・見原朋也氏の2名。本稿は講演の中で語られた、アイドルたちの魅力を出すために行われた数々の“こだわり”を紹介するレポートとなる。\n\n文／はくまいさん\n編集／anymo\n\n・■「約6万ポリゴン」で構成されるアイドルたち。「みずみずしさ」をキーワードに開発\n\n杉村貴之氏は、2006年から3DCGデザイナーとしてさまざまなゲーム開発・リアルタイム映像エンジン開発に携わったとのこと。『学園アイドルマスター』においては3Dモデルディレクション、ゲーム内イベント“初星コミュ”の映像演出を担当する。\n\n見原朋也氏はQualiArtsにて複数のモバイルゲーム開発に携わり、主にパイプライン周りのテクニカルアーティストとして効率化や事故防止に従事しているという。\n\nそして『学園アイドルマスター』は、2024年5月16日よりiOS、Androidにて配信されているスマホ向けゲーム。\n\nプレイヤーがプロデューサーとなってアイドルたちを育成していく『アイドルマスター』シリーズ最新作のシミュレーションゲームとして人気を集めている作品だ。\n\n本題に入り、まず「3Dビジュアルコンセプト/レンダリング概要」についての紹介が行われた。『学園アイドルマスター』は新規シリーズとして当初から「みずみずしさ」というキーワードを掲げて開発が行われていたという。\n\n杉村貴之氏は講演内で「みずみずしさ」についてさらにひも解いており、生命力や躍動感、透明感に美しさ、さらには息づいている様、はじける輝きなども含んでいると紹介。そうしてQualiArtsの技術を踏襲しつつ「『モバイル3D美少女の最高クオリティ』を目指す」という目標に向かって開発を進めたことを明かした。\n\nまた、複数人でのライブよりも絵的に見劣りがちな「ソロライブ」という条件の中で最大限のクオリティを追及したという。キャラクターモデル1体ごとの表現力・個性・実存感を増すほか、リアルライブのような臨場感を演出するシーンや背景を制作していたようだ。\n\nそして次は「キャラクターモデルの解説」が行われ、本作のキャラクターモデルを制作する上で大事にした「表現」を7項目で紹介された。このあたりに関しては文章で解説するよりも実際に画像を見た方が非常に分かりやすいため、下部の画像を確認されたい。\n\nこの中でも特に“こだわり”が見られるところとしては「衣装造形・質感の作り込み」にて語られたポイントだろう。\n\n杉村氏はアイドル衣装について「ある種“戦闘服への変身姿”といったものに似た特別感だったり、迫力といったものを備えたもの」として捉え、3Dモデルでも似た感覚を感じさせることにこだわったとのこと。\n\n次は「メッシュ・骨」のパートに入り、モデルの仕様部分が紹介された。昨今のコンソールゲームでは何十万というポリゴン数を使う作品もある中、本作のキャラクターモデルは「約6万ポリゴン」という規格で制作され、“アニメやイラストのような滑らかさ”を目指したという。\n\nポリゴンの内訳についてはカクカクとした“ポリゴン感”を抑えるために頭部に全体の半分程度のポリゴンを割き、ボーンはトータルで321本のうち200本が髪の毛や衣類などの「揺れ物」関係になっている。\n\nその次は、ライブ等でキャラクターたちをさらに魅力的に仕立て上げる「ライティング」についてとなる。『学園アイドルマスター』ではキャラクターに使用するものと背景などに使うものは違う種類のライティングを使用しており、今回は前者の「キャラライティング」が紹介された。\n\n本作においてキャラクターに使用するライトは、影の基本を作る「トゥーン陰影用メインライト」、ポイントライトやスポットライトなどで明るさを強める「加算ライト」など5種類となる。\n\nそして「シェーダー・テクスチャ」。キャラクター1体あたりに使用されるシェーダーは9種類、マテリアルは9～11マテリアル、テクスチャは8種類となっている。\n\nシェーダーの数が多い理由としては、前髪から眉が見えたり、顔面の陰影の処理などのトゥーンキャラクター独自の表現を演出するために特殊な部位分けが必要とのことで、複数の種類が取り揃えられている。\n\nマテリアルはシェーダーと一対一で対応するものになっているためほとんど同じ数となっており、衣装によっては複数のマテリアルでひとつのシェーダーを利用する場合もあるという。\n\nそしてテクスチャマップは8枚となっているが各キャラクターごとに特殊なテクスチャがあるため、実際にはキャラクター1体あたり約30枚ものテクスチャファイルが必要とのこと。\n\nまた、衣装や体における陰影の出力・質感の違いを描き分けている「Defテクスチャ」の仕様、一枚のテクスチャで肌の陰影と肌以外の陰影を描く「陰影ランプ」の仕様といった、一部のテクスチャに関しての詳細も明かにされている。\n\nこれらの仕様を組み合わせるだけでベタっとした影がなだらかなグラデーションに変化するのがはっきりと分かるため、どちらも非常に大切なものになっているようだ。\n\nそしてもうひとつのランプ「質感ランプ」は、視線の角度によって色が変化するオーロラ素材や偏光塗料などを疑似的に再現したものになる。特殊な表現を行う際に使用するだけではなく、通常の衣装に使用していたり、服の皺のディティールを表現する際に使用していたりするため、かなりの利便性を持ち合わせているようだ。\n\nまた、前髪から目が透ける表現はシェーダーによって目や眉を透けさせ、髪のテクスチャのアルファチャンネルで透ける領域と透け具合を制御、さらに角度によって透ける度合いがフェードする仕様になっている。もちろん、キャラクターごとに調整も行われている。\n\nさらに影側の頬にライトを残らせる「顔陰影反転テクスチャ（顔のDefテクスチャ）」に加えて「汗」と「髪の乱れ張り付き」を表現しているところも解説され、トゥーン調のグラフィックなのにも関わらず現実に存在しているかのようなリアリティを追及しまくる“こだわり”を確認できた。\n\n・■「鼻ポチ」制御も明らかに。アイドルたちの魅力的な表情の仕組み\n\nここからは進行役が見原朋也氏に変わり、アイドルたちの魅力のひとつである“豊かな表情”を生み出す「フェイシャル」について紹介された。豊富なフェイシャル表現は骨、ブレンドシェイプ、デカール、MotionEffectの4要素から構成されているとのこと。\n\n骨は瞳の視線アニメーションと舌のアニメーションの2箇所で使用。ブレンドシェイプは1キャラクターあたり100個以上のターゲットから構成されているとのことで、本来ならばそれぞれ処理する必要から処理コストが高いとされているが、「GraphicsBuffer」を用いた“独自のスキニング”により高速化&軽量化を実現することができたという。\n\nデカールに関しては「URPDecalProjector」を改変したものを利用し、チークや青ざめなどの表現に活用したとのことだ。\n\nそしてMotionEffectはぐるぐる目や涙といった特殊な表現に使用されている。仕様についてはPrefabを用いたものとマテリアルを用いたもののふたつが解説された。\n\n「MotionEffectの仕様 Prefab」では下記画像に記載されているプロパティを持ち、基本的にパーティクルシステムを含むPrefabを生成する際に使用し、Prefabの親となるロケーターがキャラクターごとに適切な位置に配置しているとのこと。\n\nそして前述された“独自のスキニング”がここで恩恵を与えていると明かし、頂点の移動量を取得できるようになり、アニメーターが新しく意識せずとも違和感の無い表現をできるようになったという。\n\nそして「MotionEffectの使用 Material」も同様に下記画像に記載されているプロパティを持ち、テクスチャを差し替える時に利用したとのこと。また、必要に応じて目をキラリと光らせたりといったUVアニメーションも可能となっているようだ。\n\n次はブレンドシェイプを用いた「角度による顔の形状補正」となる。この項目ではどの角度でもアイドルたちが魅力的に見せられるよう、カメラアングルによって顔の形状が変わることが解説された。\n\n補正がオフの状態とオンの状態を比べた画像も用意されており、補正がオンの状態だと顎のラインがシュッとした形状になっているのを確認できる。見比べてみると非常に分かりやすく、下から見た時の印象が異なるのが分かるだろう。\n\nそしてその次はさまざまなアニメやイラストなどで使用される鼻の表現「鼻ポチ」を自然にフェードアウトさせる「鼻ポチ制御」が解説された。\n\n3Dモデルで「鼻ポチ」をそのまま行ってしまうと横から見た際に悪目立ちしてしまうため、横から見たときに対応するメッシュを後ろに下げる、というシンプルなつくりで制御していることを明かした。\n\nこの「鼻ポチ制御」についてはリリース当初にSNSでも話題となり、今回ついにその仕組みが判明したかたちとなる。\n\nここからはキャラクターモデルのより細かな部分となる頂点カラー、法線、補助骨、揺れ骨について紹介された。\n\nモデルの頂点カラーはアウトラインのカラーと太さ、オフセットを調整する3つと、貫通ランプを塗り分けるためのID情報、リムマスクを設定する5つが使用されている。\n\nひとつのフェイスチャンネルにつき合計で7つの頂点情報が必要とのことで、単純に設定してしまうとカラーセットをふたつ用意しなければならないため、それぞれの情報を4ビットに圧縮して格納しているという。\n\nMaya上ではカラーセットをふたつ用意して7つのチャンネルを編集。専用のエディタを用いて意図した値を入力するフローを経たのち、エクスポート時にひとつに圧縮して格納したとのこと。\n\nリムマスクについては、頂点カラーだけで定義してしまうと細かい制御ができないため「陰影オフセット（DefテクスチャのRチャンネル）」を使用し、服の質感をうまく作ったという。\n\n次に「法線仕様」について。シェーディングに使われるモデルの頂点法線は顔のみ手作業で編集したとのことで、顔のポリゴンの密度が一定以上あるため造形のままの法線で大きな破綻もなくシェーディングできたという。\n\nしかし、モデリングの法線状態でアウトラインと落影に使用すると期待通りに行かない箇所や落影が分離するという問題が発生し、そのまま使用することができないという課題もあったようだ。\n\n見原朋也氏は「この課題を解消するためには別の法線を用意する必要がある」と語り、Mayaからエクスポートする際に自動変換を行い、UV2に法線XYを、UV3に法線Zを格納してUnityでインポートする時にTangentに変換して利用するという解決方法を紹介した。\n\nそして「補助骨」ではMayaとUnityどちらも自前のシステムで動かしていると言い、はじめに人体に関することが語られた。\n\n補助骨は手首などを動かすとボリュームが減少してしまうことの対策として、手首や上腕などに入れられている。\n\nまた、腰に組み込んで曲げたときに体が潰れてしまうことを防ぐほか、肘や膝などに組み込んで曲げた際に角を立たせてシルエットを強調する用途にも使われている。\n\n「揺れもの」も補助骨と同じシステムを使用しており、揺らしたいものに対してダイナミックボーンを入れ、基礎骨に衝突判定を作るためにスタティックボーンを組み込んでいるという。\n\nロングヘアーやジャケットなどの風などになびくものはチェーン状にダイナミックボーンを組み込み、快適なクロスシミュレーションのような挙動を実現した。\n\nしかし、多重構造の衣類を使用する際にはダイナミックボーン同士が干渉してしまい、計算量が多くなることもある。その場合はスカート側の角度を参照してジャケットの骨がスカートの内側に入らないよう、リアルタイムに角度制限を行うシステムを実装したという。\n\nまた、最後に「揺れもの」には回転値が変化し髪や衣装の裾など汎用的に使用可能な「スイングモード」、移動値が変化し衣装の袖や皮膚揺れなど限定的に使用する「スライドモード」が存在することも明かされた。\n\nそしてここからは「こだわり・工夫」のパートに入り、実際のキャラクターモデルにおけるいくつかのこだわりポイントが紹介された。\n\nそもそも『学園アイドルマスター』のアイドルたちの身体造形は体型タイプを使い回しておらず、ひとりひとりの個性を活かすために一体ずつ制作している。具体的にはベースとなる完全に中間の素体から始まり、設定などに基づいて筋肉と脂肪のパラメーターなどを決めてそれぞれのアイドルに合った体にするといった具合に造形を行う。\n\nメッシュでは各部位ごとにアイドルの設定に基づいた肉付けを行って個性を表現し、テクスチャでは主に筋肉や脂肪などの質感を出している。\n\nこれらに関しては人体の解剖学的観点に基づきながらもリアルになり過ぎないよう、ある程度アニメ的な簡略化表現に近いバランスを目指して何度も書き込みの調整を行う、という細かな“こだわり”ポイントを見せてくれた。\n\n髪の毛のモデリングについては立体的な造形や柔らかさだけではなく、テクスチャ、とくに「陰影オフセット」によって毛流れの表現をなめらかに、そして美しく作りこんだと語られた。\n\nそして、毛先に関しては「ここまでで良い」と思うところからさらにもう一歩、細く長く作って綺麗に抜けさせる。さらに、おくれ毛やほつれ毛は一本ずつ丁寧に作り、配置や流れ方にも気を配るという。\n\nまた、綺麗な造形だけにはとどまらず、髪の目立つ場所にはたった“髪の毛一本”のためだけにボーンを組み込んでいたり、前髪や顔周辺の髪など目に止まりやすい場所には特にボーンを入れこんでいたり、隣り合う髪のパラメーターが異なっていたりと、特に顔周辺の造形に関してはかなりの情熱を持って作られたのが分かるだろう。\n\n続いては「衣装造形」となり、「生きた人間が、実際に着ている」と感じられる服の描写について語られた。\n\nまず、もとのデザイン画から3Dモデルに起こす際に生地の素材を考慮した皺のでき方を各衣装それぞれの固さ、柔らかさ、張力の方向などが適切かどうかを一つひとつ調整したという。中でも「藤田ことね」の衣装など、ダボついたボリュームのある衣装は中々難易度が高く苦労したと杉村貴之氏は語る。\n\nまた、衣装によっては袖の内部や靴の裏、タイツの質感など、ゲームのような埋め立て方をせずどこまでも妥協せずに作りこむことでアイドルたちが実際に存在するかのように見せているという。\n\n表情に関しては『学園アイドルマスター』のストーリーがギャグやドタバタ感満載なコミカルに展開することが多いため、通常の喜怒哀楽といった表情に加えて沢山のかわいらしい表情を実装したとのこと。\n\nまた、頬をつねる際にはブレンドシェイプで地道に作ったり、それぞれのアイドルの瞳のカラーやハイライトの入れ方などがひとりひとり異なるため個別に調整したりと、どこまでもアイドルたちを魅力的に見せるための“こだわり”をここでも見ることができた。\n\nそして先ほども一度登場した衣装のボーンに関することも紹介された。ボーンを追加していくとその分負荷がかかってしまうが、どこにどの程度使うのかというのを各衣装で検討し、できるだけ有意義な場所にボーンを多く入れるようにしたという。\n\n画像ではわかりにくいが、スカートの末端に一本ボーンが追加されるだけでもかなり柔らかくフワっとした動きになり、フリルがより個別に動いているように見えるのが確認できた。\n\nまた、半袖やショートパンツなどの丈が短いものにもボーンを組み込み、アイドルの動きに躍動感をさらに追加させたとのこと。\n\nそして次は「皮膚揺れ」についてとなる。太ももやふくらはぎ、二の腕などにスライドボーンを組み込み、モーションに合わせて動かすことによってポリゴンモデルでありつつも柔らかなキャラクター表現を持たせることを模索したという。\n\nまた、杉村貴之氏はただボーンを追加するだけだと思ったように皮膚が揺れなかったという課題に対し、「力が発生しやすい上下の力を揺れが見えやすい左右の力に加算し、細かい揺れが発生しやすくさせる」という解決方法を提示した。\n\n次に「風システム」について。髪や衣装に組み込まれた揺れものは風によって動くようになっており、開発陣は当初のシンプルなものから一変、風で揺れる髪の毛をもっと情感的に表現したくなったようだ。\n\n下部の画像の黄色部分で構成された風に青部分の「揺れ全体の強弱を制御」と赤部分の「ランダム性を追加付与」を実装し、ナチュラルな風表現を実現したという。\n\nそして次はライブ時に使用される「観客の解説」。群衆システムは約500ポリゴンで制作された大人数用と約1000ポリゴンで制作された少人数用の2種類が存在する。\n\n観客は大きく分けて「ローポリモデル」と「群衆システム」のふたつに分類して制作されており、まずはローポリモデルについて解説された。\n\nローポリモデルはアイドルたちと同じ骨構造で、補助骨や揺れ骨などが組み込まれていないシンプルなものになっている。\n\n品質設定ごとにモデルとして描写する上限が設定されているとのことで、上限を超えたモデルはランタイムで生成されたビルボードが使用される仕組みになっている。\n\nまた、群衆のデータはひとつのシーンにつき最大8種類のモデルを組み合わせてひとつのスクリプトオブジェクトとして管理しており、楽曲に応じて専用の観客を表示することもできるとのこと。\n\nこれらの処理はComputeShaderで行うことにより、1万人程度の観客を高速でなおかつ低負荷で描写できるようになったという。\n\n次は「背景シーンの解説」のパートとなる。『学園アイドルマスター』の背景はさまざまな特徴を持っており、ひとつは「DeferredRendering」を活かしてステージに大量のライトを設置し、動的に変化していくライブを本格的に演出できるようにしたところだ。\n\nそしてもうひとつの特徴は、リアルライブらしさを感じさせるステージ表現になる。生のライブの臨場感を高めるため、機材やカメラスタッフ、コンソールなどの表現を盛り込み、実際のライブと同じ雰囲気を演出しているという。\n\n次にライティングやシェーディング周りの解説が行われた。『学園アイドルマスター』では背景のほとんどのオブジェクトには標準的なPBR用シェーダとテクスチャを使用する。\n\nそして1マテリアルにつき「アルベド」、「ノーマル」、「Def（質感用）」の3つのテクスチャで1セットで管理しているとのこと。\n\nまた、本講演では詳細は語られなかったものの「水面用シェーダ」や「ライブモニター用シェーダ」など、用途別にシェーダが存在していることも明かされた。その中でも「デカール用シェーダ」は特に背景の品質向上に役立ったという。\n\nそして特に効果的だったと語られたのが、リアルタイムライトへの「GI乗算」になる。\n\n当初のままだと下部画像の左側のようにどこかのっぺりとしたものになっていたが、リアルタイムのライトによる照明にライトマップ・ライトプローブの事前計算結果をかけあわせ、間接照明・ソフトシャドウやバウンスカラーを含めた照明効果を得たとのこと。\n\nまた、もうひとつGI的なライト機能として「BackLightning」が存在する。こちらではGI乗算を用いても二次反射のない照明ではオブジェクト裏側とのコントラストがきつく、硬い画になってしまうという。\n\nその問題については、逆方向からもライティングを行って合成することで緩和させるという方法で解決していた。\n\n次に背景におけるスペキュラ反射に関する表現が紹介された。反射表現には「ライトのスペキュラ」、「ReflectionProbe」、「ScreenSpaceReflection」、「PlanarReflection」の4種類が存在しており、最大ですべて組み合わせたものを使用している。\n\n特にレッスン室や着替え部屋などの鑑に使用している「PlanarReflection」に関してはほかのものとは異なる反射表現となっており、実際に鏡面用のモデルを精製しているためにカメラ外の景観を含めた反射像が的確に表現されているとのこと。\n\nそして背景に関する詳細の最後として、こだわりや工夫したポイントも紹介されている。ここで先に触れた「デカール用シェーダ」の詳細な解説が行われ、8つの種類の中から水たまりや黒板の文字、床や壁の模様に使用するといった汎用性の高さを持っていることが紹介された。\n\n中でも特殊なのが「ライトデカール」と呼ばれるもので、Unityに標準搭載されているライトよりも非常に動作が軽く、何百ものライトを同時に光らせることができるというものになっている。\n\n・■床の表面の傷や汚れまで再現するライブステージへのこだわり\n\nそしてここからは「ライブステージのこだわり」の紹介に入り、まず最初に水平アングルで見られる床平面の歪み表現について語られた。ここでは床の表面の傷や汚れなどのディティールにも気を配り、反射の特性が変化する様子などもリアルさを追及するという“こだわり”が紹介された。\n\n次に機材についてとなる。本作のライブに登場するムービングライトやフラットライトをはじめ、レーザー、キャノン砲、フレームシューターなどの機材は実在するものを基に制作したとのこと。\n\nもちろん機材そのものだけではなくそれらを置く台や階段、トラスなども機材のうちに含まれているため、ひとつのライブだけで数多くのアセットを用意していることがわかるだろう。\n\nそして本講演の最後の項目となる「ポストエフェクト・環境効果」についての話が行われた。\n\n『学園アイドルマスター』における主要なポストエフェクトは下の画像の通りになる。「内製DOF」については解像度が変化しても同じサイズで玉ボケが行える描写を実現し、Unity標準の43サンプルから30サンプルに減らして負荷も削減しているとのこと。\n\nまた、UnityBokehDOFと自作BokehDOFを比較した画像もあったがその差は一目瞭然。\n\nボリュメトリック関連は、環境フォグについて基本的な距離フォグと球状フォグを利用しているという。\n\nスポットライトにおけるボリューム表現に関しては「Volumetoric Light Beam」というアセットを利用。それに対してUnityのレンダリング機能である「HDRP」の「DepthShadow」をURPで使えるように機能を追加し、ライトボリューム内での動くオブジェクトの影や遮蔽を表現したとのこと。\n\nこれで内容としては以上になるが、最後に本講演における「まとめ」が行なわれた。\n\n『学園アイドルマスター』はキャラクターモデル一体にリソースを集中させて髪や衣装の造形・揺れ物などの細部に“こだわり”を持つことで生命観・存在感を演出。そしてアイドルたちの「個性」を描くため、共通させられる部分も固有の制作を追及。\n\nさらに多様で豊かなフェイシャル表現によって柔らかく生き生きとした表情を生み出し、ライブ客をステージではアイドルたちに熱狂する観客が見える存在としてしっかり描き、数々の技術を活かして魅力的なライティング・演出を実現したといったかたちでまとめられた。\n\nそうして最後に杉村貴之氏は「一事例ではありますが、モバイル向けの3Dゲーム開発、また、3D美少女モデルの制作事例として少しでもご参考になれば幸いです」と語り、「『学園アイドルマスター』は今後もさらに魅力的な体験をお届けするべく、チーム一同頑張ってまいりますのでどうぞ引き続きよろしくお願いいたします」とのコメントも残した。\n電ファミニコゲーマー：,['https://newsatcl-pctr.c.yimg.jp/t/amd-img/20240909-01225021-denfami-000-4-view.jpg?exp=10800'],"['https://news.yahoo.co.jp/articles/9dde3c844419ce2fb2ca2e43704472f5b33bd918/images/000', 'https://news.denfaminicogamer.jp/news/240909a/attachment/2_1-1-2']"
